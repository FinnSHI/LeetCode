# 背包九讲

## 01背包问题

### 题目

有 $N$ 件物品和一个容量为 $X$ 的背包。第 $i$ 件物品的重量是 $w_i$，价值是 $v_i$。求解将哪些物品装入背包可使这些物品的重量总和不超过背包容量，且价值总和最大。

### 特点

1. 每种物品仅有1件。可以选择放或者不放。

### 思路

每个物品可以选择**放**或**不放**

- 设前 $i$ 件物品放入现在重量为 $x$ 的背包的总价值为 $f[i][x]$，则对于第 $i$ 件物品：
  - 第 $i$ 件物品不放背包，$f[i][x]=f[i-1][x]$
  - 第 $i$ 件物品放入背包，$f[i][x]=f[i-1][x-w_i]+v[i]$，即上一个物品的在重量为 $x-w_i$ 时候的价值加上第 $i$ 个的价值 $v[i]$，这样重量才能变成 $x$。

### 复杂度

时间复杂度：$O(N*V)$

空间复杂度：$O(N*V)$，可优化成 $O(N)$

#### 优化

因为 $f[i][x]$ 只和 $f[i-1][x]$ 有关，因此可以简化成 $f[x]=max(f[x], f[x-w[i]]+v[i])$。空间复杂度优化成了 $O(N)$。但是这种情况，需要逆序。

### 例题

有 $N$ 件物品和一个容量是 $V$ 的背包。每件物品只能使用一次。

第 $ii$ 件物品的体积是 $v_i$，价值是 $w_i$。

求解将哪些物品装入背包，可使这些物品的总体积不超过背包容量，且总价值最大。
输出最大价值。

#### 输入格式

第一行两个整数，$N$，$V$，用空格隔开，分别表示物品数量和背包容积。

接下来有 $N$ 行，每行两个整数 $v_i$, $w_i$，用空格隔开，分别表示第 $i$ 件物品的体积和价值。

#### 输出格式

输出一个整数，表示最大价值。

#### 数据范围

0<$N,V$≤1000
0<$v_i,w_i$≤1000

#### 输入样例

```
4 5
1 2
2 4
3 4
4 5
```

#### 输出样例：

```
8
```

#### 代码

```java
class Main{
    public static void main(String[] args) {
        Scanner sc = new Scanner(System.in);
        String firstLine = sc.nextLine();
        String[] firstLines = firstLine.split(" ");
        int N = Integer.parseInt(firstLines[0]); // 物品数量
        int X = Integer.parseInt(firstLines[1]); // 书包总重量
        int[] w = new int[N]; // 物品重量
        int[] val = new int[N]; // 物品价值
        int count = 0;
        while (sc.hasNextLine()) {
            String s = sc.nextLine();
            if(s.equals("")) {
                break;
            }
            String[] s1 = s.split(" ");
            w[count] = Integer.parseInt(s1[0]);
            val[count] = Integer.parseInt(s1[1]);
            count++;
        }

        int[][] dp = new int[N][X+1];
        for(int i = 0; i < N; i++) {
            for(int x = w[i]; x <= X; x++) {
                if(i != 0) {
                    dp[i][x] = Math.max(dp[i-1][x], dp[i-1][x-w[i]] + val[i]);
                }
            }
        }

        System.out.println(dp[N-1][X]);
    }
}
```



## 完全背包问题

### 题目

有 $N$ 种物品和一个容量为 $X$ 的背包，每种物品都有**无限件可用**。第 $i$ 种物品的重量是 $w_i$，价值是 $v_i$。求解将哪些物品装入背包可使这些物品的费用总和不超过背包容量，且价值总和最大。

### 特点

1. 每种物品有无限件。可以选择放0、1、2......个。

### 思路

每种物品有无限件。可以选择放0、1、2......个。

- 设前 $i$ 件物品放入现在容量为 $x$ 的背包的总价值为 $f[i][x]$，则对于第 $i$ 件物品：
  - $f[i][x]=max([i-1][v-k×w_i]+k×v_i, 0<=k×w[i]<=x)$

### 复杂度

时间复杂度：$O(N*X*k*x[i])$

空间复杂度：$O()$，可优化成 $O()$



## 多重背包问题

### 题目

有 $N$ 种物品和一个容量为 $X$ 的背包，第 $i$ 种物品最多有 $n$ 件可用。第 $i$ 种物品的重量是 $w_i$，价值是 $v_i$。求解将哪些物品装入背包可使这些物品的费用总和不超过背包容量，且价值总和最大。

### 特点

1. 每种物品最多有 n 件。可以选择放0、1、2.....n个。

### 思路

每种物品最多有 n 件。可以选择放0、1、2.....n个

- 设前 $i$ 件物品放入现在容量为 $x$ 的背包的总价值为 $f[i][x]$，则对于第 $i$ 件物品：
  - $f[i][x]=max([i-1][v-k×w_i]+k×v_i, 0<=k×w[i]<=x, 0<=k<=n)$

### 复杂度

时间复杂度：$O()$

空间复杂度：$O()$，可优化成 $O()$
